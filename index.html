<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Smart Queue - Live Queue Dashboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600;800&display=swap" rel="stylesheet">
  <style>
    
    body {
      font-family: 'Inter', sans-serif;
      background: linear-gradient(135deg, #0F172A 0%, #1E293B 50%, #334155 100%);
      color: #F8FAFC;
      min-height: 100vh;
      position: relative;
      overflow-x: hidden;
    }

    /* Animated Background Elements */
    .bg-shapes {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
      pointer-events: none;
    }

    .shape {
      position: absolute;
      border-radius: 50%;
      background: linear-gradient(135deg, rgba(56, 189, 248, 0.1), rgba(129, 140, 248, 0.1));
      animation: float 12s infinite linear;
    }

    .shape:nth-child(1) {
      width: 60px;
      height: 60px;
      top: 20%;
      left: 10%;
      animation-delay: 0s;
    }

    .shape:nth-child(2) {
      width: 80px;
      height: 80px;
      top: 60%;
      right: 15%;
      animation-delay: 7s;
    }

    .shape:nth-child(3) {
      width: 40px;
      height: 40px;
      bottom: 20%;
      left: 20%;
      animation-delay: 14s;
    }

    .shape:nth-child(4) {
      width: 100px;
      height: 100px;
      top: 10%;
      right: 5%;
      animation-delay: 3s;
    }

    .shape:nth-child(5) {
      width: 50px;
      height: 50px;
      bottom: 10%;
      right: 30%;
      animation-delay: 10s;
    }

    .shape:nth-child(6) {
      width: 70px;
      height: 70px;
      top: 50%;
      left: 35%;
      animation-delay: 5s;
    }

    @media (min-width: 768px) {
      .shape:nth-child(1) { width: 80px; height: 80px; }
      .shape:nth-child(2) { width: 120px; height: 120px; }
      .shape:nth-child(3) { width: 60px; height: 60px; }
    }

    @keyframes float {
      0%, 100% { transform: translateY(0px) rotate(0deg); }
      33% { transform: translateY(-30px) rotate(120deg); }
      66% { transform: translateY(20px) rotate(240deg); }
    }

    .gradient-text {
      background: linear-gradient(135deg, #38BDF8, #818CF8, #C084FC);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-size: 200% 200%;
      animation: gradientShift 3s ease-in-out infinite;
    }

    @keyframes gradientShift {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }

    .hero-title {
      font-size: clamp(2.5rem, 8vw, 6rem);
      font-weight: 900;
      letter-spacing: -0.02em;
      line-height: 0.9;
      text-shadow: 0 0 30px rgba(56, 189, 248, 0.3);
    }

    .hero-subtitle {
      font-size: clamp(1rem, 4vw, 1.5rem);
      opacity: 0.8;
      animation: fadeInUp 1s ease-out 0.5s both;
    }

    .hero-description {
      animation: fadeInUp 1s ease-out 0.7s both;
    }

    .hero-stats {
      animation: fadeInUp 1s ease-out 0.9s both;
    }

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .pulse-ring {
      animation: pulseRing 2s ease-out infinite;
    }

    @keyframes pulseRing {
      0% {
        transform: scale(0.8);
        opacity: 1;
      }
      100% {
        transform: scale(2.4);
        opacity: 0;
      }
    }

    .loader {
      border: 4px solid #334155;
      border-top: 4px solid #38BDF8;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .table-row-group tr {
      transition: all 0.3s ease;
      transform: translateX(-20px);
      opacity: 0;
      animation: slideInLeft 0.6s ease forwards;
    }

    .table-row-group tr:nth-child(2) { animation-delay: 0.1s; }
    .table-row-group tr:nth-child(3) { animation-delay: 0.2s; }
    .table-row-group tr:nth-child(4) { animation-delay: 0.3s; }
    .table-row-group tr:nth-child(5) { animation-delay: 0.4s; }

    @keyframes slideInLeft {
      to {
        transform: translateX(0);
        opacity: 1;
      }
    }

    .table-row-group tr:hover {
      background-color: #1E293B;
      transform: translateX(4px) scale(1.01);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
    }

    @media (min-width: 768px) {
      .table-row-group tr:hover {
        transform: translateX(8px) scale(1.01);
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
      }
    }

    .meal-btn {
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      overflow: hidden;
      touch-action: manipulation;
      -webkit-tap-highlight-color: transparent;
    }

    .meal-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
      transition: left 0.5s;
    }

    .meal-btn:hover::before,
    .meal-btn:active::before {
      left: 100%;
    }

    .meal-btn.active {
      background: linear-gradient(135deg, #0284C7, #0369A1);
      color: white;
      box-shadow: 0 4px 15px rgba(2, 132, 199, 0.4);
      transform: translateY(-1px);
    }

    @media (min-width: 768px) {
      .meal-btn.active {
        box-shadow: 0 8px 25px rgba(2, 132, 199, 0.4);
        transform: translateY(-2px);
      }
    }

    .glass-card {
      background: rgba(30, 41, 59, 0.7);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(56, 189, 248, 0.1);
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .glass-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 15px 35px rgba(0, 0, 0, 0.4);
      border-color: rgba(56, 189, 248, 0.3);
    }

    @media (min-width: 768px) {
      .glass-card {
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
      }
      
      .glass-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 30px 60px rgba(0, 0, 0, 0.4);
      }
    }

    .btn-primary {
      background: linear-gradient(135deg, #38BDF8, #0EA5E9);
      box-shadow: 0 4px 15px rgba(56, 189, 248, 0.3);
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
      touch-action: manipulation;
      -webkit-tap-highlight-color: transparent;
    }

    .btn-primary:hover,
    .btn-primary:active {
      transform: translateY(-1px);
      box-shadow: 0 6px 20px rgba(56, 189, 248, 0.4);
    }

    @media (min-width: 768px) {
      .btn-primary:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(56, 189, 248, 0.4);
      }
    }

    .btn-primary:active {
      transform: translateY(0);
    }

    .btn-success {
      background: linear-gradient(135deg, #10B981, #059669);
      transition: all 0.3s ease;
      touch-action: manipulation;
      -webkit-tap-highlight-color: transparent;
    }

    .btn-success:hover,
    .btn-success:active {
      transform: translateY(-1px) scale(1.02);
      box-shadow: 0 4px 15px rgba(16, 185, 129, 0.4);
    }

    @media (min-width: 768px) {
      .btn-success:hover {
        transform: translateY(-1px) scale(1.05);
        box-shadow: 0 6px 20px rgba(16, 185, 129, 0.4);
      }
    }

    .scroll-reveal {
      opacity: 0;
      transform: translateY(30px);
      transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
    }

    @media (min-width: 768px) {
      .scroll-reveal {
        transform: translateY(50px);
      }
    }

    .scroll-reveal.revealed {
      opacity: 1;
      transform: translateY(0);
    }

    .hero-icon {
      animation: bounceIn 1s ease-out;
      filter: drop-shadow(0 0 15px rgba(56, 189, 248, 0.5));
    }

    @media (min-width: 768px) {
      .hero-icon {
        filter: drop-shadow(0 0 20px rgba(56, 189, 248, 0.5));
      }
    }

    @keyframes bounceIn {
      0% { transform: scale(0.3) rotate(-180deg); opacity: 0; }
      50% { transform: scale(1.05) rotate(-10deg); }
      70% { transform: scale(0.9) rotate(5deg); }
      100% { transform: scale(1) rotate(0deg); opacity: 1; }
    }
    
    .notification-enter {
      animation: notificationSlideIn 0.5s cubic-bezier(0.4, 0, 0.2, 1) forwards;
    }

    .notification-exit {
      animation: notificationSlideOut 0.3s ease-in forwards;
    }

    @keyframes notificationSlideIn {
      from { transform: translateX(100%); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }

    @keyframes notificationSlideOut {
      from { transform: translateX(0); opacity: 1; }
      to { transform: translateX(100%); opacity: 0; }
    }

    /* Mobile-specific improvements */
    @media (max-width: 767px) {
      .hero-title {
        line-height: 1.1;
      }
      
      .mobile-stack {
        flex-direction: column;
        gap: 1rem;
      }
      
      .mobile-full {
        width: 100%;
      }
      
      .mobile-text-sm {
        font-size: 0.875rem;
      }
      
      .mobile-px-4 {
        padding-left: 1rem;
        padding-right: 1rem;
      }
      
      .mobile-py-3 {
        padding-top: 0.75rem;
        padding-bottom: 0.75rem;
      }
      
      .mobile-hidden {
        display: none;
      }
      
      .table-responsive {
        font-size: 0.875rem;
      }
      
      .notification-mobile {
        bottom: 1rem;
        right: 1rem;
        left: 1rem;
        min-width: auto;
      }
    }

    /* Touch improvements */
    @media (hover: none) and (pointer: coarse) {
      .meal-btn:hover,
      .glass-card:hover,
      .btn-primary:hover,
      .btn-success:hover,
      .table-row-group tr:hover {
        transform: none;
        box-shadow: inherit;
      }
      
      .meal-btn:active,
      .btn-primary:active,
      .btn-success:active {
        transform: scale(0.98);
      }
      
      .glass-card:active {
        transform: scale(0.99);
      }
    }
  </style>
</head>
<body class="antialiased">
  <!-- Animated Background -->
  <div class="bg-shapes">
    <div class="shape"></div>
    <div class="shape"></div>
    <div class="shape"></div>
    <div class="shape"></div>
    <div class="shape"></div>
    <div class="shape"></div>
  </div>

  <!-- Hero Section -->
  <section class="relative min-h-screen flex items-center justify-center px-4 sm:px-6">
    <div class="text-center max-w-6xl mx-auto">
      <div class="hero-icon mb-6 sm:mb-8">
        <div class="relative inline-block">
          <div class="absolute inset-0 pulse-ring bg-sky-400 rounded-full opacity-20"></div>
          <i class="fa-solid fa-utensils text-6xl sm:text-8xl text-sky-400 relative z-10"></i>
        </div>
      </div>
      
      <h1 class="hero-title gradient-text mb-4 sm:mb-6">
        Smart<span class="text-white"> Queue</span>
      </h1>
      
      <p class="hero-subtitle text-slate-300 mb-6 sm:mb-8 max-w-3xl mx-auto px-4">
        Skip the Queues, Not Meals
      </p>
      
      <div class="hero-description mb-8 sm:mb-12">
        <p class="text-lg sm:text-xl text-slate-400 max-w-2xl mx-auto leading-relaxed px-4">
          Experience seamless meal service with real-time queue tracking and efficient student management.
        </p>
      </div>
      
      <div class="flex flex-col sm:flex-row gap-3 sm:gap-4 justify-center px-4">
        <a href="#dashboard" class="btn-primary text-white font-bold px-6 sm:px-8 py-3 sm:py-4 rounded-xl text-base sm:text-lg inline-flex items-center justify-center">
          <i class="fa-solid fa-chart-line mr-2 sm:mr-3"></i>
          View Dashboard
        </a>
        <a href="#add-student" class="glass-card hover:bg-slate-700/50 text-slate-300 font-bold px-6 sm:px-8 py-3 sm:py-4 rounded-xl text-base sm:text-lg inline-flex items-center justify-center">
          <i class="fa-solid fa-user-plus mr-2 sm:mr-3"></i>
          Add Student
        </a>
      </div>
    </div>

    <div class="absolute bottom-6 sm:bottom-10 left-1/2 transform -translate-x-1/2 animate-bounce">
      <i class="fa-solid fa-chevron-down text-xl sm:text-2xl text-slate-400"></i>
    </div>
  </section>

  <!-- Main Dashboard -->
  <main class="container mx-auto px-4 sm:px-6 md:px-12 py-8 sm:py-12 scroll-reveal" id="dashboard">
    <!-- Add Student Form -->
    <section class="mb-8 sm:mb-12 scroll-reveal" id="add-student">
      <div class="glass-card p-4 sm:p-8 rounded-2xl">
        <h2 class="text-xl sm:text-2xl font-bold mb-4 sm:mb-6 text-center">
          <i class="fa-solid fa-user-plus text-sky-400 mr-2 sm:mr-3"></i>
          Add Student to Queue
        </h2>
        <form id="add-student-form" class="mobile-stack flex flex-col sm:flex-row gap-3 sm:gap-6 items-stretch sm:items-center">
          <input type="text" id="student-name-input" placeholder="Enter student's name" 
                 class="mobile-full flex-grow bg-slate-700/50 border-2 border-slate-600/50 text-white rounded-xl px-4 sm:px-6 py-3 sm:py-4 focus:ring-2 focus:ring-sky-500 focus:border-sky-500 outline-none transition-all backdrop-blur-sm text-base" required>
          <select id="meal-select" class="mobile-full bg-slate-700/50 border-2 border-slate-600/50 text-white rounded-xl px-4 sm:px-6 py-3 sm:py-4 focus:ring-2 focus:ring-sky-500 focus:border-sky-500 outline-none transition-all backdrop-blur-sm text-base">
            <option>Breakfast</option>
            <option selected>Lunch</option>
            <option>Dinner</option>
          </select>
          <button type="submit" id="add-student-btn" class="mobile-full btn-primary text-white font-bold px-6 sm:px-8 py-3 sm:py-4 rounded-xl transition-all flex items-center justify-center whitespace-nowrap text-base">
            <i class="fa-solid fa-plus mr-2 sm:mr-3"></i> Add Student
          </button>
        </form>
      </div>
    </section>

    <!-- Meal Selector -->
    <section class="mb-6 sm:mb-8 scroll-reveal">
      <div id="meal-selector-container" class="glass-card p-2 sm:p-3 rounded-2xl">
        <div class="flex gap-2 sm:gap-3">
          <button class="meal-btn flex-1 font-semibold text-slate-300 py-3 sm:py-4 px-3 sm:px-6 rounded-xl text-sm sm:text-base" data-meal="Breakfast">
            <i class="fa-solid fa-cloud-sun"></i>
            <span class="hidden xs:inline">Breakfast</span>
            <span class="xs:hidden">Breakfast</span>
          </button>
          <button class="meal-btn flex-1 font-semibold text-slate-300 py-3 sm:py-4 px-3 sm:px-6 rounded-xl active text-sm sm:text-base" data-meal="Lunch">
            <i class="fa-solid fa-sun mr-1 sm:mr-2"></i>Lunch
          </button>
          <button class="meal-btn flex-1 font-semibold text-slate-300 py-3 sm:py-4 px-3 sm:px-6 rounded-xl text-sm sm:text-base" data-meal="Dinner">
            <i class="fa-solid fa-moon mr-1 sm:mr-2"></i>Dinner
          </button>
        </div>
      </div>
    </section>

    <!-- Live Queue Stats Section -->
    <section class="mb-6 sm:mb-8 scroll-reveal">
      <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 sm:gap-6">
        <!-- Now Serving Card -->
        <div class="glass-card p-6 rounded-2xl text-center">
          <p class="text-sm font-semibold text-sky-400 mb-2">NOW SERVING</p>
          <p id="stat-now-serving" class="text-4xl font-extrabold text-white">--</p>
        </div>
        <!-- Total Waiting Card -->
        <div class="glass-card p-6 rounded-2xl text-center">
          <p class="text-sm font-semibold text-sky-400 mb-2">TOTAL WAITING</p>
          <p id="stat-total-waiting" class="text-4xl font-extrabold text-white">0</p>
        </div>
        <!-- Est. Wait Card -->
        <div class="glass-card p-6 rounded-2xl text-center">
          <p class="text-sm font-semibold text-sky-400 mb-2">EST. WAIT FOR NEW ENTRY</p>
          <p id="stat-est-wait" class="text-4xl font-extrabold text-white">~ 0 min</p>
        </div>
      </div>
    </section>

    <!-- Queue Table Section -->
    <section id="queue-section" class="scroll-reveal">
      <div class="glass-card rounded-2xl shadow-2xl overflow-hidden">
        <div class="p-4 sm:p-8 border-b border-slate-700/50">
          <h2 class="text-2xl sm:text-3xl font-bold mb-2">
            <i class="fa-solid fa-list-ol text-sky-400 mr-2 sm:mr-3"></i>
            <span class="hidden sm:inline">Current Queue: </span>
            <span class="sm:hidden">Queue: </span>
            <span id="current-meal-title" class="gradient-text">Lunch</span>
          </h2>
          <p class="text-slate-400 text-sm sm:text-lg">Real-time view of students waiting for their meal</p>
        </div>
        <div class="w-full overflow-x-auto">
          <table class="w-full text-left table-responsive">
            <thead class="bg-slate-800/70 border-b border-slate-700/50">
              <tr>
                <th class="p-3 sm:p-6 text-xs sm:text-sm font-bold tracking-wider uppercase text-sky-400">
                  <i class="fa-solid fa-hashtag mr-1 sm:mr-2"></i>Token
                </th>
                <th class="p-3 sm:p-6 text-xs sm:text-sm font-bold tracking-wider uppercase text-sky-400">
                  <i class="fa-solid fa-user mr-1 sm:mr-2"></i>Student Name
                </th>
                <th class="p-3 sm:p-6 text-xs sm:text-sm font-bold tracking-wider uppercase text-sky-400">
                  <i class="fa-solid fa-clock mr-1 sm:mr-2"></i>Est. Wait
                </th>
                <th class="p-3 sm:p-6 text-xs sm:text-sm font-bold tracking-wider uppercase text-center text-sky-400">
                  <i class="fa-solid fa-cog mr-1 sm:mr-2"></i>
                  <span class="hidden sm:inline">Action</span>
                  <span class="sm:hidden">Act</span>
                </th>
              </tr>
            </thead>
            <tbody id="queue-table-body" class="table-row-group">
            </tbody>
          </table>
        </div>
        <div id="loader-container" class="flex justify-center items-center p-8 sm:p-16">
          <div class="loader"></div>
        </div>
        <div id="empty-state" class="hidden text-center p-8 sm:p-16">
          <i class="fa-solid fa-mug-saucer text-3xl sm:fa-4x text-slate-500 mb-4 sm:mb-6"></i>
          <p class="text-lg sm:text-xl font-semibold text-slate-400 mb-2">The queue is empty!</p>
          <p class="text-sm sm:text-base text-slate-500">No students are currently waiting for this meal.</p>
        </div>
      </div>
    </section>

    <!-- About Section -->
    <section id="about-section" class="mt-12 scroll-reveal">
      <div class="glass-card p-8 rounded-2xl">
        <h2 class="text-2xl sm:text-3xl font-bold mb-6 text-center">
          <i class="fa-solid fa-info-circle text-sky-400 mr-3"></i>
          About Smart Queue
        </h2>
        <p class="text-lg text-slate-300 max-w-3xl mx-auto text-center leading-relaxed mb-10">
          Smart Queue is a project dedicated to solving the persistent problem of long queues and waiting times in campus canteens and corporate cafeterias. By leveraging real-time data and a simple, intuitive interface, we aim to create a stress-free and efficient dining experience for everyone.
        </p>
        <div class="border-t border-slate-700/50 pt-8">
            <h3 class="text-3xl sm:text-4xl font-extrabold text-center mb-10 
            font-['Orbitron',monospace] text-sky-400 
            drop-shadow-[0_0_10px_#0ea5e9]">
                ⚡ HackMasterz ⚡
            </h3>
            
          <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-8">
            <!-- Team Member 1 -->
            <div class="text-center">
              <img src="https://ui-avatars.com/api/?name=Manas+Sharma&background=0ea5e9&color=fff&size=128" alt="Team Member Manas Sharma" class="w-32 h-32 rounded-full mx-auto mb-4 border-4 border-slate-600/50 shadow-lg">
              <h4 class="text-xl font-bold">Manas Sharma</h4>
              
            </div>
            <!-- Team Member 2 -->
            <div class="text-center">
              <img src="https://ui-avatars.com/api/?name=Vivek+Kaushik&background=8b5cf6&color=fff&size=128" alt="Team Member Vivek Kaushik" class="w-32 h-32 rounded-full mx-auto mb-4 border-4 border-slate-600/50 shadow-lg">
              <h4 class="text-xl font-bold">Vivek Kaushik</h4>
             
            </div>
            <!-- Team Member 3 -->
            <div class="text-center">
              <img src="https://ui-avatars.com/api/?name=King+Kapoor&background=10b981&color=fff&size=128" alt="Team Member King Kapoor" class="w-32 h-32 rounded-full mx-auto mb-4 border-4 border-slate-600/50 shadow-lg">
              <h4 class="text-xl font-bold">King Kapoor</h4>
             
            </div>
            <!-- Team Member 4 -->
            <div class="text-center">
              <img src="https://ui-avatars.com/api/?name=Shreya+Patra&background=f59e0b&color=fff&size=128" alt="Team Member Shreya Patra" class="w-32 h-32 rounded-full mx-auto mb-4 border-4 border-slate-600/50 shadow-lg">
              <h4 class="text-xl font-bold">Shreya Patra</h4>
              
            </div>
            <!-- Team Member 5 -->
            <div class="text-center">
              <img src="https://ui-avatars.com/api/?name=Aditi+Varshney&background=ef4444&color=fff&size=128" alt="Team Member Aditi Varshney" class="w-32 h-32 rounded-full mx-auto mb-4 border-4 border-slate-600/50 shadow-lg">
              <h4 class="text-xl font-bold">Aditi Varshney</h4>
              
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>
  
  <div id="notification" class="notification-mobile hidden fixed bottom-8 right-8 text-white py-3 sm:py-4 px-4 sm:px-6 rounded-xl shadow-2xl z-50 min-w-80">
    <div class="flex items-center">
      <i id="notification-icon" class="fa-solid fa-check-circle mr-2 sm:mr-3 text-lg sm:text-xl"></i>
      <p id="notification-text" class="font-semibold text-sm sm:text-base"></p>
    </div>
  </div>

  <script>

   // --- Bluish neon fork cursor (improved design) ---
  (function() {
    const svg = `<svg xmlns='http://www.w3.org/2000/svg' width='32' height='32' viewBox='0 0 64 64'>
      <g transform='rotate(-20 32 32)' stroke='#2dd7ff' stroke-width='2' fill='none'>
        
        <!-- Fork prongs -->
        <line x1='20' y1='4' x2='20' y2='20' stroke='#66f3ff' stroke-width='3' stroke-linecap='round'/>
        <line x1='28' y1='4' x2='28' y2='20' stroke='#66f3ff' stroke-width='3' stroke-linecap='round'/>
        <line x1='36' y1='4' x2='36' y2='20' stroke='#66f3ff' stroke-width='3' stroke-linecap='round'/>
        <line x1='44' y1='4' x2='44' y2='20' stroke='#66f3ff' stroke-width='3' stroke-linecap='round'/>
        
        <!-- Fork base curve -->
        <path d='M18 20 Q32 28 46 20' stroke='#66f3ff' stroke-width='2' fill='none'/>
        
        <!-- Handle -->
        <rect x='28' y='22' width='8' height='36' rx='4' ry='4' fill='#66f3ff' stroke='#2dd7ff'/>
      </g>
    </svg>`;

    // encode and build data URL
    const dataUrl = 'data:image/svg+xml;utf8,' + encodeURIComponent(svg);

    // Set cursor on body (hotspot at 16 16). Add fallback 'auto'.
    document.body.style.cursor = `url("${dataUrl}") 16 16, auto`;
  })();


    const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxssexhP1bFA998g9cIHa2Cam94IXWh4g09w0_Ds5CMuedkXsiLCIOJAQTHzokXMD5W/exec';
    const AVG_TIME_PER_PERSON_MINUTES = 3;

    const queueTableBody = document.getElementById('queue-table-body');
    const loaderContainer = document.getElementById('loader-container');
    const emptyState = document.getElementById('empty-state');
    const notification = document.getElementById('notification');
    const notificationText = document.getElementById('notification-text');
    const notificationIcon = document.getElementById('notification-icon');
    const addStudentForm = document.getElementById('add-student-form');
    const studentNameInput = document.getElementById('student-name-input');
    const mealSelect = document.getElementById('meal-select');
    const addStudentBtn = document.getElementById('add-student-btn');
    const mealSelectorContainer = document.getElementById('meal-selector-container');
    const currentMealTitle = document.getElementById('current-meal-title');
    const statNowServing = document.getElementById('stat-now-serving');
    const statTotalWaiting = document.getElementById('stat-total-waiting');
    const statEstWait = document.getElementById('stat-est-wait');

    let currentMeal = 'Lunch';

    // Smooth scrolling
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener('click', function (e) {
        e.preventDefault();
        const target = document.querySelector(this.getAttribute('href'));
        if (target) {
          target.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
      });
    });

    // Scroll reveal animation
    const observerOptions = {
      threshold: 0.1,
      rootMargin: '0px 0px -30px 0px'
    };

    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('revealed');
        }
      });
    }, observerOptions);

    document.querySelectorAll('.scroll-reveal').forEach(el => {
      observer.observe(el);
    });

    function showNotification(message, isError = false) {
      notificationText.textContent = message;
      notificationIcon.className = isError ? 'fa-solid fa-exclamation-circle mr-2 sm:mr-3 text-lg sm:text-xl' : 'fa-solid fa-check-circle mr-2 sm:mr-3 text-lg sm:text-xl';
      notification.classList.remove('hidden', 'bg-green-500', 'bg-red-500');
      notification.classList.add(isError ? 'bg-red-500' : 'bg-green-500', 'notification-enter');
      
      setTimeout(() => {
        notification.classList.add('notification-exit');
        setTimeout(() => {
          notification.classList.add('hidden');
          notification.classList.remove('notification-enter', 'notification-exit');
        }, 300);
      }, 4000);
    }

    async function fetchQueue() {
      loaderContainer.style.display = 'flex';
      emptyState.style.display = 'none';
      queueTableBody.innerHTML = '';

      try {
        const url = `${SCRIPT_URL}?meal=${currentMeal}`;
        const response = await fetch(url);
        const data = await response.json();
        if (data.success) {
          updateTable(data.queue);
        } else {
          showNotification(data.error || 'Failed to fetch queue data.', true);
        }
      } catch (error) {
        showNotification('Could not connect to the backend script.', true);
      } finally {
        loaderContainer.style.display = 'none';
      }
    }
    
    function updateTable(queue) {
      // Update stats
      statNowServing.textContent = queue.length > 0 ? queue[0].token : '--';
      statTotalWaiting.textContent = queue.length;
      statEstWait.textContent = `~ ${queue.length * AVG_TIME_PER_PERSON_MINUTES} min`;

      queueTableBody.innerHTML = '';
      if (queue.length === 0) {
        emptyState.style.display = 'block';
      } else {
        queue.forEach((student, index) => {
          const waitTime = index * AVG_TIME_PER_PERSON_MINUTES;
          const tr = document.createElement('tr');
          tr.className = 'border-b border-slate-700/30';
          tr.style.animationDelay = `${index * 0.1}s`;
          tr.innerHTML = `
            <td class="p-3 sm:p-6">
              <span class="inline-flex items-center justify-center w-10 h-10 sm:w-12 sm:h-12 bg-sky-500/20 text-sky-400 font-bold text-base sm:text-lg rounded-full border-2 border-sky-500/30">
                ${student.token}
              </span>
            </td>
            <td class="p-3 sm:p-6">
              <div class="flex items-center">
                <div class="w-8 h-8 sm:w-10 sm:h-10 bg-gradient-to-br from-sky-400 to-indigo-500 rounded-full flex items-center justify-center text-white font-bold mr-3 sm:mr-4 text-sm sm:text-base">
                  ${student.name.charAt(0).toUpperCase()}
                </div>
                <span class="text-sm sm:text-lg font-medium">${student.name}</span>
              </div>
            </td>
            <td class="p-3 sm:p-6 text-sm sm:text-base font-medium text-slate-300">
              <i class="fa-regular fa-clock mr-2 text-sky-400"></i>
              ~ ${waitTime} min
            </td>
            <td class="p-3 sm:p-6 text-center">
              <button class="meal-received-btn btn-success text-white font-semibold px-3 sm:px-6 py-2 sm:py-3 rounded-xl text-xs sm:text-sm transition-all inline-flex items-center" data-row="${student.row}">
                <i class="fa-solid fa-check mr-1 sm:mr-2"></i>
                <span class="hidden sm:inline">Meal Received</span>
                <span class="sm:hidden">Done</span>
              </button>
            </td>
          `;
          queueTableBody.appendChild(tr);
        });
      }
    }

    async function handleMealReceived(e) {
      const button = e.target.closest('.meal-received-btn');
      if (!button) return;

      button.disabled = true;
      button.innerHTML = `<i class="fa-solid fa-spinner animate-spin mr-1 sm:mr-2"></i>
                <span class="hidden sm:inline">Processing...</span>
                <span class="sm:hidden">Wait</span>`;
      const rowToUpdate = button.dataset.row;
      
      try {
        const url = `${SCRIPT_URL}?action=markServed&row=${rowToUpdate}`;
        const response = await fetch(url);
        const result = await response.json();
        if (result.success) {
          showNotification('Student marked as served! 🎉', false);
        } else {
          showNotification(result.error || 'Failed to update status.', true);
        }
      } catch (error) {
        showNotification('Failed to update status.', true);
      } finally {
        fetchQueue();
      }
    }
    
    async function handleAddStudent(e) {
      e.preventDefault();
      const name = studentNameInput.value.trim();
      const meal = mealSelect.value;
      if (!name) return;

      addStudentBtn.disabled = true;
      addStudentBtn.innerHTML = `<i class="fa-solid fa-spinner animate-spin mr-2 sm:mr-3"></i>
                <span class="hidden sm:inline">Adding...</span>
                <span class="sm:hidden">Wait</span>`;

      try {
        const url = `${SCRIPT_URL}?action=addStudent&name=${encodeURIComponent(name)}&meal=${meal}`;
        const response = await fetch(url);
        const result = await response.json();

        if(result.success) {
          showNotification(`${name} has been added to the queue! 🍽️`, false);
          studentNameInput.value = '';
        } else {
          showNotification(result.error || 'Failed to add student.', true);
        }
      } catch (error) {
        showNotification('Failed to add student.', true);
      } finally {
        addStudentBtn.disabled = false;
        addStudentBtn.innerHTML = `<i class="fa-solid fa-plus mr-2 sm:mr-3"></i> Add Student`;
        // Always refresh the current queue after an attempt
        if (meal === currentMeal) {
            fetchQueue();
        }
      }
    }

    function handleMealSelect(e) {
      const selectedButton = e.target.closest('.meal-btn');
      if (!selectedButton) return;

      currentMeal = selectedButton.dataset.meal;
      currentMealTitle.textContent = currentMeal;

      document.querySelectorAll('.meal-btn').forEach(btn => btn.classList.remove('active'));
      selectedButton.classList.add('active');

      fetchQueue();
    }

    // Mobile notification positioning
    function updateNotificationPosition() {
      const notification = document.getElementById('notification');
      if (window.innerWidth <= 767) {
        notification.classList.add('notification-mobile');
      } else {
        notification.classList.remove('notification-mobile');
      }
    }

    // Handle window resize
    window.addEventListener('resize', updateNotificationPosition);

    document.addEventListener('DOMContentLoaded', () => {
      if (SCRIPT_URL === 'PASTE_YOUR_GOOGLE_APPS_SCRIPT_URL_HERE' || !SCRIPT_URL.includes('google.com')) {
        loaderContainer.style.display = 'none';
        showNotification('ERROR: Please paste your Apps Script URL in the HTML file.', true);
        return;
      }
      
      updateNotificationPosition();
      fetchQueue(); 
      setInterval(fetchQueue, 15000);
      
      queueTableBody.addEventListener('click', handleMealReceived);
      addStudentForm.addEventListener('submit', handleAddStudent);
      mealSelectorContainer.addEventListener('click', handleMealSelect);

      // Prevent zoom on input focus (iOS)
      if (/iPad|iPhone|iPod/.test(navigator.userAgent)) {
        const inputs = document.querySelectorAll('input, select');
        inputs.forEach(input => {
          input.addEventListener('focus', () => {
            if (input.style.fontSize !== '16px') {
              input.style.fontSize = '16px';
            }
          });
          input.addEventListener('blur', () => {
            input.style.fontSize = '';
          });
        });
      }
    });
  </script>
</body>
</html>

